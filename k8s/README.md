# é‡‘èå¾®æœå‹™ Kubernetes + eBPF å®‰å…¨æ¼”ç¤º

## ğŸ—ï¸ éšæ®µ2ï¼šKubernetes + Cilium + Tetragon éƒ¨ç½²

### æ¶æ§‹æ¦‚è¿°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Kubernetes Cluster                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Cilium CNI (eBPF-based networking & security)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Tetragon (eBPF Runtime Security Observability)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é‡‘èå¾®æœå‹™ Pods                                              â”‚
â”‚  â”œâ”€â”€ Trading API                                           â”‚
â”‚  â”œâ”€â”€ Risk Engine                                           â”‚
â”‚  â”œâ”€â”€ Payment Gateway                                       â”‚
â”‚  â””â”€â”€ Audit Service                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ éƒ¨ç½²è¦æ±‚

### ç³»çµ±è¦æ±‚
- Kubernetes 1.25+
- Linux Kernel 5.4+ (æ”¯æŒeBPF)
- è‡³å°‘ 8GB RAM
- 4 CPU cores

### æ”¯æŒçš„éƒ¨ç½²ç’°å¢ƒ
- **æœ¬åœ°é–‹ç™¼**: Kind, Minikube, K3s
- **é›²ç«¯**: EKS, GKE, AKS
- **è‡ªå»º**: kubeadm

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### æ–¹æ³•1ï¼šä¸€éµéƒ¨ç½²è…³æœ¬
```bash
# å…‹éš†é …ç›®
git clone <repository>
cd fintech-ebpf-demo/k8s

# åŸ·è¡Œéƒ¨ç½²è…³æœ¬
./deploy.sh
```

### æ–¹æ³•2ï¼šé€æ­¥éƒ¨ç½²
```bash
# 1. å‰µå»ºKindé›†ç¾¤
./scripts/setup-kind-cluster.sh

# 2. å®‰è£Cilium CNI
./scripts/install-cilium.sh

# 3. éƒ¨ç½²Tetragon
./scripts/install-tetragon.sh

# 4. éƒ¨ç½²é‡‘èå¾®æœå‹™
kubectl apply -f manifests/

# 5. é©—è­‰éƒ¨ç½²
./scripts/verify-deployment.sh
```

## ğŸ” eBPF ç›£æ§åŠŸèƒ½

### Tetragon å®‰å…¨ç­–ç•¥
- æ–‡ä»¶ç³»çµ±ç›£æ§
- ç¶²çµ¡æµé‡åˆ†æ
- é€²ç¨‹åŸ·è¡Œè¿½è¹¤
- ç³»çµ±èª¿ç”¨ç›£æ§

### ç›£æ§é‡é»
1. **æ•æ„Ÿæ–‡ä»¶è¨ªå•**
   - `/etc/passwd`, `/etc/shadow`
   - SSLè­‰æ›¸å’Œç§é‘°
   - æ•¸æ“šåº«é…ç½®æ–‡ä»¶

2. **å¯ç–‘ç¶²çµ¡æ´»å‹•**
   - å¤–éƒ¨DNSæŸ¥è©¢
   - æœªæˆæ¬Šçš„å‡ºç«™é€£æ¥
   - å…§éƒ¨æœå‹™é–“ç•°å¸¸é€šä¿¡

3. **å±éšªå‘½ä»¤åŸ·è¡Œ**
   - Shellå‘½ä»¤æ³¨å…¥
   - æ¬Šé™æå‡å˜—è©¦
   - åŠ å¯†è²¨å¹£æŒ–ç¤¦è¡Œç‚º

## ğŸ“Š ç›£æ§å’ŒæŒ‡æ¨™

### Prometheus + Grafana
- é›†ç¾¤è³‡æºä½¿ç”¨ç‡
- å¾®æœå‹™æ¥­å‹™æŒ‡æ¨™
- eBPFå®‰å…¨äº‹ä»¶çµ±è¨ˆ

### Tetragon Events
- å¯¦æ™‚å®‰å…¨äº‹ä»¶æµ
- JSONæ ¼å¼æ—¥èªŒè¼¸å‡º
- å¯é›†æˆSIEMç³»çµ±

## ğŸ”’ å®‰å…¨æ¼”ç¤ºå ´æ™¯

### å ´æ™¯1ï¼šå‘½ä»¤æ³¨å…¥æ”»æ“Š
```bash
# è§¸ç™¼Trading APIçš„å‘½ä»¤åŸ·è¡Œæ¼æ´
kubectl exec -it <trading-api-pod> -- curl -X POST localhost:8080/debug/execute \
  -d '{"command":"cat","args":["/etc/passwd"]}'
```

### å ´æ™¯2ï¼šæ•æ„Ÿæ–‡ä»¶è¨ªå•
```bash
# è§¸ç™¼æ–‡ä»¶è®€å–ç›£æ§
kubectl exec -it <pod> -- cat /root/.ssh/id_rsa
```

### å ´æ™¯3ï¼šç•°å¸¸ç¶²çµ¡æ´»å‹•
```bash
# è§¸ç™¼DNSæŸ¥è©¢ç›£æ§
kubectl exec -it <payment-pod> -- nslookup malicious-domain.com
```

## ğŸ“ æ–‡ä»¶çµæ§‹

```
k8s/
â”œâ”€â”€ README.md                 # æœ¬æ–‡ä»¶
â”œâ”€â”€ deploy.sh                 # ä¸€éµéƒ¨ç½²è…³æœ¬
â”œâ”€â”€ scripts/                  # éƒ¨ç½²è…³æœ¬
â”‚   â”œâ”€â”€ setup-kind-cluster.sh
â”‚   â”œâ”€â”€ install-cilium.sh
â”‚   â”œâ”€â”€ install-tetragon.sh
â”‚   â””â”€â”€ verify-deployment.sh
â”œâ”€â”€ manifests/                # Kubernetes manifests
â”‚   â”œâ”€â”€ namespace.yaml
â”‚   â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ microservices/
â”‚   â”œâ”€â”€ monitoring/
â”‚   â””â”€â”€ rbac/
â”œâ”€â”€ tetragon/                 # Tetragoné…ç½®
â”‚   â”œâ”€â”€ policies/
â”‚   â””â”€â”€ events/
â”œâ”€â”€ cilium/                   # Ciliumé…ç½®
â”‚   â””â”€â”€ values.yaml
â””â”€â”€ helm/                     # Helm charts
    â””â”€â”€ fintech-demo/
```

## âš ï¸ æ³¨æ„äº‹é …

1. **å®‰å…¨è­¦å‘Š**: æ­¤ç³»çµ±åŒ…å«æ•…æ„æ¼æ´ï¼Œåƒ…ç”¨æ–¼æ¼”ç¤º
2. **è³‡æºè¦æ±‚**: ç¢ºä¿é›†ç¾¤æœ‰è¶³å¤ è³‡æº
3. **å…§æ ¸æ”¯æŒ**: é©—è­‰eBPFåŠŸèƒ½å¯ç”¨æ€§
4. **ç¶²çµ¡ç­–ç•¥**: Ciliumç¶²çµ¡å®‰å…¨ç­–ç•¥å·²å•Ÿç”¨

## ğŸ”„ ä¸‹ä¸€æ­¥

å®ŒæˆKuberneteséƒ¨ç½²å¾Œï¼Œå°‡é€²å…¥ï¼š
- **éšæ®µ3**: Reactå‰ç«¯é–‹ç™¼
- **éšæ®µ4**: æ”»æ“Šå ´æ™¯è…³æœ¬
- **éšæ®µ5**: å®Œæ•´æ¼”ç¤ºç’°å¢ƒ

---

**ç‰ˆæœ¬**: 2.0.0  
**éšæ®µ**: Kubernetes + eBPF éƒ¨ç½²  
**æ›´æ–°æ—¥æœŸ**: 2023-12-01 