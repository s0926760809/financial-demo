# é‡‘èå¾®æœå‹™eBPFæ¼”ç¤ºç³»çµ±

é€™æ˜¯ä¸€å€‹åŠŸèƒ½å®Œæ•´çš„é‡‘èäº¤æ˜“å¹³å°æ¼”ç¤ºç³»çµ±ï¼ŒåŒ…å«å‰ç«¯Reactæ‡‰ç”¨å’Œå››å€‹Goå¾®æœå‹™å¾Œç«¯ã€‚ç³»çµ±ä½¿ç”¨çœŸå¯¦çš„APIé€£æ¥ï¼Œä¸å†ä¾è³´æ¨¡æ“¬æ•¸æ“šã€‚

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹

### å‰ç«¯ (React + TypeScript + Vite)
- **ç«¯å£**: 5173
- **æ¡†æ¶**: React 18 + TypeScript + Vite + Ant Design
- **é é¢**: å„€è¡¨æ¿ã€æŠ•è³‡çµ„åˆã€äº¤æ˜“ã€ç›£æ§ã€è¨­å®š
- **ç‰¹æ€§**: å¯¦æ™‚æ•¸æ“šæ›´æ–°ã€éŸ¿æ‡‰å¼è¨­è¨ˆã€å®Œæ•´çš„APIé›†æˆ

### å¾Œç«¯å¾®æœå‹™

| æœå‹™åç¨± | ç«¯å£ | ç‹€æ…‹ | æè¿° |
|---------|------|------|------|
| **Trading API** | 30080 | âœ… å¥åº· | äº¤æ˜“è¨‚å–®è™•ç†ã€æŠ•è³‡çµ„åˆç®¡ç†ã€å¸‚å ´æ•¸æ“š |
| **Risk Engine** | 30081 | âœ… å¥åº· | é¢¨éšªè©•ä¼°ã€é™é¡æ§åˆ¶ã€å‘Šè­¦ç³»çµ± |
| **Payment Gateway** | 30082 | âœ… å¥åº· | æ”¯ä»˜è™•ç†ã€é€€æ¬¾ç®¡ç†ã€å¤–éƒ¨APIé›†æˆ |
| **Audit Service** | 30083 | âœ… å¥åº· | å¯©è¨ˆæ—¥èªŒã€åˆè¦ç›£æ§ã€äº‹ä»¶è¿½è¹¤ |

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. å•Ÿå‹•å¾Œç«¯æœå‹™

æ¯å€‹æœå‹™éƒ½æœ‰è‡ªå·±çš„é…ç½®æ–‡ä»¶ï¼Œç¢ºä¿æ­£ç¢ºçš„ç«¯å£é…ç½®ï¼š

```bash
# å•Ÿå‹•æ‰€æœ‰å¾Œç«¯æœå‹™
cd backend/trading-api && ./trading-api > trading-api.log 2>&1 &
cd ../risk-engine && ./risk-engine > risk-engine.log 2>&1 &
cd ../payment-gateway && ./main > payment-gateway.log 2>&1 &
cd ../audit-service && ./audit-service > audit-service.log 2>&1 &
```

### 2. å•Ÿå‹•å‰ç«¯

```bash
cd frontend
npm install
npm run dev
```

å‰ç«¯å°‡åœ¨ http://localhost:5173 ä¸Šé‹è¡Œ

### 3. é©—è­‰æœå‹™ç‹€æ…‹

```bash
# æª¢æŸ¥æ‰€æœ‰æœå‹™å¥åº·ç‹€æ…‹
curl http://localhost:30080/health  # Trading API
curl http://localhost:30081/health  # Risk Engine  
curl http://localhost:30082/health  # Payment Gateway
curl http://localhost:30083/health  # Audit Service
```

## ğŸ“Š åŠŸèƒ½ç‰¹æ€§

### å„€è¡¨æ¿é é¢
- âœ… **çœŸå¯¦APIé›†æˆ** - ä¸å†ä½¿ç”¨æ¨¡æ“¬æ•¸æ“š
- ğŸ“ˆ æŠ•è³‡çµ„åˆæ•¸æ“šä¾†è‡ª Trading API `/api/v1/portfolio`
- ğŸ“‹ æœ€è¿‘è¨‚å–®ä¾†è‡ª Trading API `/api/v1/orders?limit=10`
- ğŸ“Š äº¤æ˜“çµ±è¨ˆä¾†è‡ª Trading API `/api/v1/trading-stats`
- ğŸ”’ å®‰å…¨äº‹ä»¶ä¾†è‡ª Audit Service `/audit/search`
- â±ï¸ **å¯¦æ™‚æ›´æ–°**: æŠ•è³‡çµ„åˆ(30s)ã€è¨‚å–®(15s)ã€å®‰å…¨äº‹ä»¶(20s)

### ç›£æ§é é¢
- âœ… **çœŸå¯¦æœå‹™ç›£æ§** - é€£æ¥å¯¦éš›çš„å¾®æœå‹™å¥åº·æª¢æŸ¥
- ğŸ¥ å¾®æœå‹™å¥åº·ç‹€æ…‹ç›£æ§ (`/health` endpoints)
- ğŸ“ˆ ç³»çµ±æŒ‡æ¨™ä¾†è‡ª Prometheus metrics (`/metrics` endpoints)
- ğŸ”„ **è‡ªå‹•åˆ·æ–°**: å¥åº·æª¢æŸ¥(30s)ã€ç³»çµ±æŒ‡æ¨™(15s)
- ğŸŒ **CORSæ”¯æŒ** - æ‰€æœ‰æœå‹™éƒ½æ”¯æŒè·¨åŸŸè«‹æ±‚

### å…¶ä»–é é¢
- ğŸ“ˆ **æŠ•è³‡çµ„åˆé é¢** - çœŸå¯¦APIæ•¸æ“šå±•ç¤º
- ğŸ’¹ **äº¤æ˜“é é¢** - å®Œæ•´çš„è¨‚å–®ç®¡ç†åŠŸèƒ½
- âš™ï¸ **è¨­å®šé é¢** - ç”¨æˆ¶é…ç½®å’Œç³»çµ±è¨­ç½®

## ğŸ”§ æŠ€è¡“é…ç½®

### æœå‹™é…ç½®
æ¯å€‹æœå‹™éƒ½æœ‰ç¨ç«‹çš„ `config.yaml` é…ç½®æ–‡ä»¶ï¼š

```yaml
# ç¤ºä¾‹é…ç½® (Risk Engine)
server:
  port: "30081"
  host: "0.0.0.0"
  mode: "release"

database:
  host: "localhost"
  port: "5432"
  user: "postgres"
  password: "password"
  dbname: "fintech_demo"

redis:
  host: "localhost"
  port: "6379"
  password: ""
  db: 0
```

### CORSè¨­ç½®
æ‰€æœ‰å¾Œç«¯æœå‹™éƒ½é…ç½®äº†CORSæ”¯æŒï¼š
- **å…è¨±çš„ä¾†æº**: `*` (æ‰€æœ‰ä¾†æº)
- **å…è¨±çš„æ–¹æ³•**: `GET, POST, PUT, DELETE, OPTIONS`
- **å…è¨±çš„é ­éƒ¨**: `Origin, Content-Type, Accept, Authorization, X-User-Id`

### APIç«¯é»

#### Trading API (30080)
- `GET /health` - å¥åº·æª¢æŸ¥
- `GET /api/v1/portfolio` - ç²å–æŠ•è³‡çµ„åˆ
- `GET /api/v1/orders` - ç²å–è¨‚å–®åˆ—è¡¨
- `GET /api/v1/trading-stats` - ç²å–äº¤æ˜“çµ±è¨ˆ
- `GET /metrics` - PrometheusæŒ‡æ¨™

#### Risk Engine (30081)
- `GET /health` - å¥åº·æª¢æŸ¥
- `POST /risk/evaluate` - é¢¨éšªè©•ä¼°
- `GET /risk/limits` - é¢¨éšªé™é¡
- `GET /metrics` - PrometheusæŒ‡æ¨™

#### Payment Gateway (30082)
- `GET /health` - å¥åº·æª¢æŸ¥  
- `POST /payment/process` - è™•ç†æ”¯ä»˜
- `GET /payment/status/:id` - æ”¯ä»˜ç‹€æ…‹
- `GET /metrics` - PrometheusæŒ‡æ¨™

#### Audit Service (30083)
- `GET /health` - å¥åº·æª¢æŸ¥
- `GET /audit/search` - æœç´¢å¯©è¨ˆæ—¥èªŒ
- `POST /audit/log` - è¨˜éŒ„å¯©è¨ˆäº‹ä»¶
- `GET /metrics` - PrometheusæŒ‡æ¨™

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

1. **æœå‹™ç„¡æ³•å•Ÿå‹•**
   ```bash
   # æª¢æŸ¥ç«¯å£æ˜¯å¦è¢«ä½”ç”¨
   netstat -an | grep LISTEN | grep -E "(30080|30081|30082|30083)"
   
   # æª¢æŸ¥æœå‹™æ—¥èªŒ
   cat backend/*/**.log
   ```

2. **å‰ç«¯CORSéŒ¯èª¤**
   - ç¢ºèªæ‰€æœ‰å¾Œç«¯æœå‹™å·²æ­£ç¢ºé…ç½®CORS
   - æª¢æŸ¥æœå‹™æ˜¯å¦æ”¯æŒOPTIONSé æª¢è«‹æ±‚

3. **å‰ç«¯é¡¯ç¤ºéŒ¯èª¤ç‹€æ…‹**
   - é©—è­‰æ‰€æœ‰æœå‹™çš„å¥åº·æª¢æŸ¥ç«¯é»
   - ç¢ºèªæœå‹™é‹è¡Œåœ¨æ­£ç¢ºçš„ç«¯å£ä¸Š

### æœå‹™ç‹€æ…‹æª¢æŸ¥

```bash
# æª¢æŸ¥æ‰€æœ‰æœå‹™é€²ç¨‹
ps aux | grep -E "(trading-api|risk-engine|main|audit-service)" | grep -v grep

# æª¢æŸ¥ç«¯å£ç›£è½
netstat -an | grep LISTEN | grep -E "(30080|30081|30082|30083)"

# æ¸¬è©¦å¥åº·æª¢æŸ¥
for port in 30080 30081 30082 30083; do
  echo "Testing port $port:"
  curl -s http://localhost:$port/health | jq '.' || echo "Failed"
done
```

## ğŸ“ˆ ç›£æ§å’ŒæŒ‡æ¨™

### PrometheusæŒ‡æ¨™
æ‰€æœ‰æœå‹™éƒ½æš´éœ² `/metrics` ç«¯é»ï¼Œæä¾›ï¼š
- **è«‹æ±‚è¨ˆæ•¸å’Œå»¶é²**
- **ç³»çµ±è³‡æºä½¿ç”¨æƒ…æ³**
- **æ¥­å‹™ç‰¹å®šæŒ‡æ¨™**
- **éŒ¯èª¤ç‡å’Œå¯ç”¨æ€§**

### æ—¥èªŒè¨˜éŒ„
- **çµæ§‹åŒ–æ—¥èªŒ** - æ‰€æœ‰æœå‹™ä½¿ç”¨JSONæ ¼å¼
- **å¯©è¨ˆè¿½è¹¤** - å®Œæ•´çš„æ“ä½œè¨˜éŒ„
- **éŒ¯èª¤è¿½è¹¤** - è©³ç´°çš„éŒ¯èª¤ä¿¡æ¯å’Œå †æ£§è¿½è¹¤

## ğŸ” å®‰å…¨ç‰¹æ€§

- **CORSä¿è­·** - é©ç•¶çš„è·¨åŸŸè³‡æºå…±äº«é…ç½®
- **è«‹æ±‚é©—è­‰** - è¼¸å…¥æ•¸æ“šé©—è­‰å’Œæ¸…ç†
- **å¯©è¨ˆæ—¥èªŒ** - æ‰€æœ‰æ“ä½œçš„å®Œæ•´è¨˜éŒ„
- **éŒ¯èª¤è™•ç†** - å®‰å…¨çš„éŒ¯èª¤éŸ¿æ‡‰

## ğŸ¯ ä¸‹ä¸€æ­¥é–‹ç™¼

- [ ] æ·»åŠ ç”¨æˆ¶èªè­‰å’Œæˆæ¬Š
- [ ] å¯¦ç¾çœŸå¯¦çš„æ•¸æ“šåº«é›†æˆ
- [ ] æ·»åŠ æ›´å¤šçš„ç›£æ§æŒ‡æ¨™
- [ ] å¯¦ç¾æœå‹™é–“é€šä¿¡å®‰å…¨
- [ ] æ·»åŠ è‡ªå‹•åŒ–æ¸¬è©¦

---

**æœ€å¾Œæ›´æ–°**: 2025-06-05  
**ç‹€æ…‹**: âœ… æ‰€æœ‰æœå‹™æ­£å¸¸é‹è¡Œï¼ŒçœŸå¯¦APIé›†æˆå®Œæˆ